pipeline{
    agent any
    
    stages{
        stage('Checkout...'){
            steps{
                echo "Checkout code..."
            }
        }
        
        stage('Hello'){
            steps{                
                sh "python3 section-08-deploying-with-containers/hello.py"                
                sh """
                python3 --version
                """
            }
        }
        
        stage('TOX-Train model..'){
            steps{
                echo "running text on Section-05 Model Package"
                //sh "python section-05-production-model-package/regression_model/train_pipeline.py"
                sh """
                python3 -m virtualenv venv 
                source /var/jenkins_home/workspace/ML-git_01/venv/bin/activate
                python3 -m pip install --upgrade pip
                python3 -m pip install --user tox
                pip3 install colorama
                pip3 install appdirs
                pip3 install -U pytest
                """ 
                sh "python3 -m tox -c section-05-production-model-package/tox.ini -e test_package"
                echo "SALIENDO text on Section-05 Model Package"
            }
        }

        stage('Deploying to prod'){
            steps{
                mvn 'clean install'
            }
        }
    }
}


