pipeline{
    agent any
    
    stages{
        stage('Checkout...'){
            steps{
                echo "Checkout code..."
            }
        }
        
        stage('Hello'){
            steps{                
                sh "python section-08-deploying-with-containers/hello.py"                
            }
        }
        
        stage('TOX-Train model..'){
            steps{
                echo "running text on Section-05 Model Package"
                //sh "python section-05-production-model-package/regression_model/train_pipeline.py" 
                script{
                    sh "echo "alias python='python3.9'" >> .bashrc"
                    sh "source .bashrc"
                    sh "python3 -m tox -c section-05-production-model-package/tox.ini -e train"
                }
            }
        }

        stage('Deployment to prod'){
        when { triggeredBy 'SCMTrigger'}
            stage('Deploy to TestEnvironment'){
                def remote = [:]
                remote.name = 'TestEnv'
                remote.host = '10.100.100.100'
            }
        }
    }
}
